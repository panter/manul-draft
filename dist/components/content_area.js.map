{"version":3,"sources":["../../src/components/content_area.jsx"],"names":["MegadraftEditor","Styles","highlightEditable","isEditing","base","outline","padding","margin","cursor","position","enhance","top","left","width","height","ContentAreaWrapper","className","style","canEdit","blockPluginDialogIsActive","startEditing","cancelEditing","locale","saveAndClose","saveAndEdit","copyLocales","copyFromLocale","setDimensions","dimensions","editorHasFocus","setEditorHasFocus","editorReadOnly","editor","styles","pointerEvents","clear","ContentAreaEditor","readOnly","contentId","entityInputs","editorState","setEditorState","megadraftActions","blockRenderMap","megadraftBlockPlugins","backgroundColor","bottom","right","ContentArea","editorProps","wrapperProps","displayName"],"mappings":"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","file":"content_area.js","sourcesContent":["import { MegadraftEditor as MegadraftEditorOrg } from 'megadraft';\nimport { Modal } from 'react-overlays';\nimport { compose, withState } from 'recompose';\nimport Measure from 'react-measure';\nimport React from 'react';\n\nimport AreaActionsToolbar from './area_actions_toolbar';\n\n// quickfix for https://github.com/globocom/megadraft/issues/97\nclass MegadraftEditor extends MegadraftEditorOrg {\n  /* eslint class-methods-use-this: 0*/\n  setReadOnly() {\n    // do nothing\n  }\n}\n\nconst Styles = ({ highlightEditable, isEditing }) => ({\n  base: {\n    ...(highlightEditable\n      ? {\n          outline: '1px dotted black',\n          padding: 15,\n          margin: -15,\n        }\n      : {}),\n    ...(isEditing\n      ? {\n          outline: '1px dotted black',\n          padding: 15,\n          margin: -15,\n        }\n      : {}),\n    cursor: highlightEditable ? 'pointer' : null,\n    position: 'relative',\n  },\n});\n\nconst enhance = compose(\n  withState('dimensions', 'setDimensions', () => ({\n    top: 0,\n    left: 0,\n    width: 100,\n    height: 100,\n  })),\n  withState('editorHasFocus', 'setEditorHasFocus', false),\n);\n\nconst ContentAreaWrapper = ({\n  className,\n  style,\n  canEdit,\n  isEditing,\n  blockPluginDialogIsActive,\n  highlightEditable,\n  startEditing,\n  cancelEditing,\n\n  locale,\n\n  saveAndClose,\n  saveAndEdit,\n  copyLocales = [],\n  copyFromLocale,\n  setDimensions,\n  dimensions,\n  editorHasFocus,\n  setEditorHasFocus,\n  editorReadOnly,\n  editor,\n}) => {\n  const styles = Styles({ highlightEditable, isEditing });\n\n  return (\n    <Measure\n      // shouldMeasure={isEditing}\n      onMeasure={setDimensions}\n    >\n      <div style={style} className={className}>\n        <div\n          style={styles.base}\n          onClick={() => canEdit && highlightEditable && startEditing()}\n        >\n          <div style={highlightEditable ? { pointerEvents: 'none' } : null}>\n            {!blockPluginDialogIsActive && canEdit && isEditing\n              ? editor\n              : editorReadOnly}\n\n            <div style={{ clear: 'both' }} />\n          </div>\n        </div>\n      </div>\n    </Measure>\n  );\n};\n\nconst ContentAreaEditor = ({\n  readOnly,\n  contentId,\n  isEditing,\n  entityInputs,\n  editorState,\n  setEditorState,\n  megadraftActions,\n  blockRenderMap,\n  megadraftBlockPlugins = [],\n  saveAndClose,\n  saveAndEdit,\n  cancelEditing,\n  locale,\n  copyLocales,\n  copyFromLocale,\n}) => (\n  <div>\n    <MegadraftEditor\n      key={`${contentId}${isEditing ? '_editing' : ''}`} // force rerender\n      actions={megadraftActions}\n      plugins={megadraftBlockPlugins}\n      readOnly={readOnly}\n      editorState={editorState}\n      entityInputs={entityInputs}\n      blockRenderMap={blockRenderMap}\n      onChange={setEditorState}\n    />\n    {isEditing && (\n      <Modal\n        backdrop={false}\n        show\n        autoFocus={false}\n        style={{\n          position: 'fixed',\n          backgroundColor: '#ffffff99',\n          bottom: 0,\n          left: 0,\n          right: 0,\n        }}\n      >\n        <AreaActionsToolbar\n          saveAndClose={saveAndClose}\n          saveAndEdit={saveAndEdit}\n          cancelEditing={cancelEditing}\n          locale={locale}\n          copyLocales={copyLocales}\n          copyFromLocale={copyFromLocale}\n        />\n      </Modal>\n    )}\n  </div>\n);\n\nconst ContentArea = enhance(\n  ({\n    isEditing,\n    entityInputs,\n    editorState,\n    setEditorState,\n    megadraftActions,\n    blockRenderMap,\n    megadraftBlockPlugins = [],\n    contentId,\n    className,\n    style,\n    canEdit,\n    blockPluginDialogIsActive,\n    highlightEditable,\n    startEditing,\n    cancelEditing,\n\n    locale,\n\n    saveAndClose,\n    saveAndEdit,\n    copyLocales = [],\n    copyFromLocale,\n    setDimensions,\n    dimensions,\n    editorHasFocus,\n    setEditorHasFocus,\n  }) => {\n    const editorProps = {\n      contentId,\n      isEditing,\n      entityInputs,\n      editorState,\n      setEditorState,\n      megadraftActions,\n      blockRenderMap,\n      megadraftBlockPlugins,\n      saveAndClose,\n      saveAndEdit,\n      cancelEditing,\n      locale,\n      copyLocales,\n      copyFromLocale,\n    };\n    const wrapperProps = {\n      className,\n      style,\n      canEdit,\n      isEditing,\n      blockPluginDialogIsActive,\n      highlightEditable,\n      startEditing,\n      cancelEditing,\n\n      locale,\n\n      saveAndClose,\n      saveAndEdit,\n      copyLocales,\n      copyFromLocale,\n      setDimensions,\n      dimensions,\n      editorHasFocus,\n      setEditorHasFocus,\n    };\n\n    return (\n      <ContentAreaWrapper\n        {...wrapperProps}\n        editor={<ContentAreaEditor {...editorProps} />}\n        editorReadOnly={<ContentAreaEditor readOnly {...editorProps} />}\n      />\n    );\n  },\n);\n\nContentArea.displayName = 'ContentArea';\n\nexport default ContentArea;\n"]}