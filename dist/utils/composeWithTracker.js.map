{"version":3,"sources":["../../src/utils/composeWithTracker.js"],"names":["composeWithTracker","myCompose","pure","withRef","reactiveFn","options","onPropsChange","props","onData","context","trackerCleanup","handler","Tracker","nonreactive","autorun","stop"],"mappings":";;;;;kBAQwBA,kB;;AARxB;;AAEA,IAAMC,YAAY,gCAAY;AAC5BC,QAAM,IADsB;AAE5BC,WAAS;AAFmB,CAAZ,CAAlB;;AAKA;AACe,SAASH,kBAAT,CAA4BI,UAA5B,EAAwCC,OAAxC,EAAiD;AAC9D,MAAMC,gBAAgB,SAAhBA,aAAgB,CAACC,KAAD,EAAQC,MAAR,EAAgBC,OAAhB,EAA4B;AAChD,QAAIC,uBAAJ;AACA,QAAMC,UAAUC,QAAQC,WAAR,CAAoB;AAAA,aAClCD,QAAQE,OAAR,CAAgB,YAAM;AACpBJ,yBAAiBN,WAAWG,KAAX,EAAkBC,MAAlB,EAA0BC,OAA1B,CAAjB;AACD,OAFD,CADkC;AAAA,KAApB,CAAhB;;AAMA,WAAO,YAAM;AACX,UAAI,OAAOC,cAAP,KAA0B,UAA9B,EAA0C;AACxCA;AACD;AACD,aAAOC,QAAQI,IAAR,EAAP;AACD,KALD;AAMD,GAdD;;AAgBA,SAAOd,UAAUK,aAAV,EAAyBD,OAAzB,CAAP;AACD","file":"composeWithTracker.js","sourcesContent":["import { setDefaults } from '@storybook/react-komposer';\n\nconst myCompose = setDefaults({\n  pure: true,\n  withRef: false,\n});\n\n/* global Tracker */\nexport default function composeWithTracker(reactiveFn, options) {\n  const onPropsChange = (props, onData, context) => {\n    let trackerCleanup;\n    const handler = Tracker.nonreactive(() =>\n      Tracker.autorun(() => {\n        trackerCleanup = reactiveFn(props, onData, context);\n      }),\n    );\n\n    return () => {\n      if (typeof trackerCleanup === 'function') {\n        trackerCleanup();\n      }\n      return handler.stop();\n    };\n  };\n\n  return myCompose(onPropsChange, options);\n}\n"]}